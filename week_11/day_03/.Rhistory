library(tidyverse)
library(cluster)
library(factoextra)
library(dendextend)
library(corrplot)
mall_cus <- read_csv("data/mall_customers.csv")
glimpse(mall_cus)
mall_cus <- read_csv("data/mall_customers.csv") %>%
janitor::clean_names()
glimpse(mall_cus)
mall_cus %>%
ggplot()+
aes(x = spending_score_1_100, y = annual_income_k)+
geom_line()
mall_cus %>%
mutate(gender = as.factor(gender))
mall_cus <- mall_cus %>%
mutate(gender = as.factor(gender))
mall_cus %>%
ggplot()+
aes(x = spending_score_1_100, y = annual_income_k, group = age)+
geom_line()
mall_cus %>%
ggplot()+
aes(x = spending_score_1_100, y = annual_income_k)+
geom_point()
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y= spending_score_1_100)+
geom_point()
mall_cus %>%
ggplot(spending_score_1_100, fill = gender)+
geom_bar
mall_cus %>%
ggplot(x = spending_score_1_100, fill = gender)+
geom_bar
mall_cus %>%
ggplot(x = spending_score_1_100, fill = gender)+
geom_bar()
mall_cus %>%
ggplot()+
aes(x = spending_score_1_100, fill = gender)+
geom_bar()
mall_cus %>%
ggplot()+
aes(x = spending_score_1_100, fill = gender)+
geom_bar(position = "dodge")
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100, colour = gender)+
geom_point()
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100, colour = age)+
geom_point()
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100, colour = as.factor(age))+
geom_point()
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100, colour = age)+
geom_point()
View(mall_cus)
mall_cus %>%
summarise(across(.col = c("annual_income_k", "spending_score_1_100"), .fns = ~mean(.x)))
mall_cus %>%
mutate(across(.col = c("annual_income_k", "spending_score_1_100"), .fns = scale))
mall_cus %>%
mutate(across(.col = c("annual_income_k", "spending_score_1_100"), .fns = scale)) %>%
summarise(across(.col = c("annual_income_k", "spending_score_1_100"), .fns = ~mean(.x)))
mall_cus_int <- mall_cus %>%
select("annual_income_k", "spending_score_1_100")
mall_cus_int %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100) %>%
geom_point()
library(broom)
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~kmeans(mall_cus_int, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_cus_int)
)
k_clusters
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~kmeans(mall_cus_int, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_cus_int)
)
clustering <- k_clusters %>%
unnest(glanced)
ggplot(clustering, aes(x = k, y = tot.withinss))+
geom_point()+
geom_line()+
scale_x_continuous(breaks = seq(1, 20, by = 1))
fviz_nbclust(mall_cus_int,
kmeans,
method = "wss",
nstart = 25)
fviz_nbclust(mall_cus_int,
kmeans,
method = "silhouette",
nstart = 25
)
fviz_nbclust(mall_cus_int,
kmeans,
method = "gab_stat",
nstart = 25,
k.max = 10)
fviz_nbclust(mall_cus_int,
kmeans,
method = "gap_stat",
nstart = 25,
k.max = 10)
clustered_mall_cus_imp <- kmeans(mall_cus_int,
centers = 5,
nstart = 25)
clustered_mall_cus_imp
mall_cus_grouped <- augment(clustered_mall_cus_imp, mall_cus)
mall_cus_grouped
mall_cus_grouped %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100)+
geom_point(aes(colour = .cluster))
tidy(clustered_mall_cus_imp,
col.names = colnames(mall_cus_int))
library(tidyverse)
library(cluster)
library(factoextra)
library(dendextend)
library(corrplot)
mall_cus <- read_csv("data/mall_customers.csv") %>%
janitor::clean_names()
glimpse(mall_cus)
mall_cus <- mall_cus %>%
mutate(gender = as.factor(gender))
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100)+
geom_point()
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100, colour = gender)+
geom_point()
mall_cus %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100, colour = age)+
geom_point()
mall_cus %>%
summarise(across(.col = c("annual_income_k", "spending_score_1_100"), .fns = ~mean(.x)))
mall_cus_int <- mall_cus %>%
select("annual_income_k", "spending_score_1_100")
# I show again the scatter plot that put in relationship the two variables of interest
mall_cus_int %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100) %>%
geom_point()
library(broom)
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~kmeans(mall_cus_int, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_cus_int)
)
clustering <- k_clusters %>%
unnest(glanced)
ggplot(clustering, aes(x = k, y = tot.withinss))+
geom_point()+
geom_line()+
scale_x_continuous(breaks = seq(1, 20, by = 1))
fviz_nbclust(mall_cus_int,
kmeans,
method = "wss",
nstart = 25)
fviz_nbclust(mall_cus_int,
kmeans,
method = "silhouette",
nstart = 25
)
fviz_nbclust(mall_cus_int,
kmeans,
method = "gap_stat",
nstart = 25,
k.max = 10)
clustered_mall_cus_imp <- kmeans(mall_cus_int,
centers = 5,
nstart = 25)
clustered_mall_cus_imp
mall_cus_grouped <- augment(clustered_mall_cus_imp, mall_cus)
mall_cus_grouped
mall_cus_grouped %>%
ggplot()+
aes(x = annual_income_k, y = spending_score_1_100)+
geom_point(aes(colour = .cluster))
tidy(clustered_mall_cus_imp,
col.names = colnames(mall_cus_int))

---
title: "Homework week 10 - day 1"
output: html_notebook
---

```{r}
library(tidyverse)
library(janitor)
library(modelr)
library(broom)
library(ggfortify)
```
# 1. Load the data into a dataframe project

```{r}
project <- read_csv("data/project_management.csv") %>% 
clean_names()
```
```{r}
glimpse(project)
```


## 2. Plot the data, taking estimated_length as the independent variable and actual_length as the dependent variable.



```{r}
project %>% 
  ggplot()+
  aes(x = estimated_length, y = actual_length)+
  geom_point()
```

## 3. Calculate the correlation coefficient of estimated_length and actual_length and interpret the value you obtain.

```{r}
project %>% 
  summarise(correlation = cor(estimated_length, actual_length))
```
The two variables seems to be very strongly positively correlated!

## 4. Perform a simple linear regression using actual_length as the dependent variable, and estimated_length as the independent variable. Save the model object to a variable.



```{r}
model <- lm(formula = actual_length ~ estimated_length, data = project)
model
```



```{r}
summary(model)
```






```{r}
project <- project %>% 
  select(-x1) %>% 
  add_predictions(model) %>% 
  add_residuals(model)

project
```


```{r}
project %>% 
  ggplot(aes(x = estimated_length))+
  geom_point(aes(y = actual_length))+
  geom_line(aes(y = pred), colour = "red")
  
```

```{r}
project %>%
  ggplot(aes(x = estimated_length, y = actual_length)) +
  geom_point() +
  geom_abline(
    intercept = model$coefficients[1],
    slope = model$coefficients[2],
    col = "red"
  )
```


## 5. Interpret the regression coefficient of estimated_length (i.e. slope, gradient) you obtain from the model. How do you interpret the r2 value reported by the model?


```{r}
glance_output <- clean_names(glance(model))
glance_output

model$coefficients[1]
model$coefficients[2]
glance_output$r_squared
```
This says that the 64,7% of the variation of actual_length is explained by variation in extimated_length.


## 6. Is the relationship statistically significant? Remember, to assess this you need to check the p-value of the regression coefficient (or slope/gradient). But you should first check the regression diagnostic plots to see if a linear regression model is appropriate and therefore if the p-value will be reliable (don’t worry about any outlier points you see in the diagnostic plots, we’ll return to them in the extension).


```{r}
autoplot(model)
```

1. That relationship is actually linear.
2. The residuals should be normally distributed!!!
3. Homosscedastic errors
   - Constant variance
   
   
   
   
   
```{r}
par(mfrow = c(2,3))
plot(model)
hist(model$residuals)
plot(model, which = 5)

```




```{r}
tidy_output <- clean_names(tidy(model))
tidy_output
```



### orrection:

Aside from outliers (certainly point 5, and perhaps point 18

), the diagnostic plots looks reasonable. The ‘Residuals vs Fitted’ plot reveals independent residuals, the ‘Normal Q-Q’ plot looks fine, and there is no systematic upward or downward trend in the the ‘Scale-Location’ plot.

The relationship is statistically significant, as the p
-value of the slope is much less than a typical α of 0.05.




```{r}
project <- add_case(project, actual_length = 3000, estimated_length = 100)

model_1 <- lm(formula = actual_length ~ estimated_length, data = project)

plot(model_1, which = c(2, 3, 5))


```






















































library(shiny)
library(tidyverse)
library(CodeClanData)

colour_choices = c(Blue = "#3891A6", Yellow = "#FDE74C", Red = "#E3655B")
shape_choices = c(Square = "15", Circle = "16", Triangle = "17")

ui <- fluidPage(
  
  #title
  titlePanel("Reaction Time vs. Memory Game"),
  
  sidebarLayout(
    
    #inputs
    sidebarPanel(
      # Colour radio buttons
      radioButtons(
        "colour_input",
        "Colour of points",
        colour_choices
      ),
      
      # transparency slider bar
      sliderInput(
        "transparency_input",
        "Transparency of points",
        min = 0,
        max = 1,
        value = 1
      ),
      
      # shape select input
      selectInput(
        "shape_input",
        "Shape of points",
        shape_choices
      ),
      
      # title select input
      textInput(
        "title_input",
        "Title of graph"
      )
    ),
    
    # plot
    mainPanel(
      plotOutput("scatter_plot")
    )
  )
)
#browser()
server <- function(input, output, session) {
  
  output$scatter_plot <- renderPlot({
    students_big %>% 
      ggplot() +
      aes(reaction_time,
          score_in_memory_game) +
      geom_point(colour = input$colour_input,
                 alpha = input$transparency_input,
                 shape = as.numeric(input$shape_input)) +
      ggtitle(input$title_input)
  })
}

shinyApp(ui, server)